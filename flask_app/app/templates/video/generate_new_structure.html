{% extends "base.html" %}

{% block title %}AI视频生成{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/video-generate.css') }}">
{% endblock %}

{% block content %}
<div x-data="videoGeneratePage()" x-init="init()">
    <!-- 页面标题区域 -->
    {% include 'video/components/header.html' %}
    
    <!-- 全自动进度条 -->
    {% include 'video/components/auto-progress.html' %}
    
    <!-- 步骤指示器 -->
    {% include 'video/components/step-indicator.html' %}
    
    <!-- 主要内容区域 -->
    <div class="row">
        <!-- 左侧配置面板 -->
        <div class="col-lg-4">
            {% include 'video/components/config-panel.html' %}
        </div>
        
        <!-- 右侧工作流面板 -->
        <div class="col-lg-8">
            {% include 'video/components/workflow-panel.html' %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/video-generate.js') }}"></script>
<script src="{{ url_for('static', filename='js/video-generate-auto.js') }}"></script>
<script>
// 初始化应用
document.addEventListener('DOMContentLoaded', function() {
    // 等待Alpine.js加载
    document.addEventListener('alpine:init', () => {
        Alpine.data('videoGeneratePage', () => {
            const app = videoGeneratePage();
            
            // 加载所有方法
            if (typeof loadAutoWorkflowMethods === 'function') {
                loadAutoWorkflowMethods(app);
            }
            if (typeof loadManualStepMethods === 'function') {
                loadManualStepMethods(app);
            }
            if (typeof loadAutoStepMethods === 'function') {
                loadAutoStepMethods(app);
            }
            
            return app;
        });
    });
});
</script>
{% endblock %}
